extends ../layout
//- TODO add info about since when I use the technology (get creation date of earliest project)

mixin skill(tech)
	- const hoursSpentWith = tech => (Object.keys(wakatimeAggregated.languages).includes(tech.URLName) ? Math.floor(wakatimeAggregated.languages[tech.URLName] / 3600) : 0)
	- const preprocessorsOf = { css: ["stylus", "sass", "vue", "nuxt", "svelte"], js: ["typescript", "livescript", "coffeescript", "vue", "nuxt", "svelte"], html: ["pug", "vue", "nuxt", "svelte", "django"], vue: ["nuxt"] }
	- const hoursIncludingPreprocs = tech => hoursSpentWith(tech) + (Object.keys(preprocessorsOf).includes(tech.URLName) ? preprocessorsOf[tech.URLName].reduce((acc, preproc) => acc + hoursSpentWith({ URLName: preproc }), 0) : 0)

	li.skill
		- const projectsCount = madeWith(all_works, tech).length

		img.logo(src=asset(`logos/${tech.URLName}.svg`))

		h4
			if tech.Author
				span.author= tech.Author
			| #{ tech.DisplayName }:

		if projectsCount > 1
			a(href=`/using/${tech.URLName}`)!= translate(`<span class="count">%d</span> projects`, projectsCount)
		else if projectsCount === 1
			a(href=`/${madeWith(all_works, tech)[0].ID}`)!= translate(`<span class="count">1</span> project`)

		if hoursIncludingPreprocs(tech)
			span.time
				span.count #{ hoursIncludingPreprocs(tech) }+&nbsp;
					if hoursIncludingPreprocs(tech) === 1
						| hour
					else
						| hours
				| of use

block append head
	+title("curriculum vitæ")
	+page-styles("resume")

block content
	- const programmingTechnologies = ["asciidoc", "coffeescript", "css", /* "csharp", "c++", "c", */ "djangorestframework", "django", "docopt", "fishshell", "go", "html", "javascript", "json", "livescript", "lua", "markdown", "nestjs", "nim", "nuxt", "oclif", "php", "plantuml", "postgresql", "pug", "python", "rubyonrails", "ruby", "rust", "sapper", "sass", "shell", "stylus", "svelte", "toml", "typescript", "vue", "webpack", "yaml", "lark", "raspberry-pi", "fyne", "nginx", "rollup", "vite", "nginx"]
	- const graphicDesignSoftware = ["figma", "gimp", "illustrator", "indesign", "photoshop", "krita", "penpot", "assembly"]
	- const motionDesignSoftware = ["aftereffects", "premierepro", "lightworks"]
	- const musicMakingSoftware = ["flstudio", "ableton"]
	- const preprocessorsOf = { css: ["stylus", "sass", "vue", "nuxt", "svelte"], js: ["typescript", "livescript", "coffeescript", "vue", "nuxt", "svelte"], html: ["pug", "vue", "nuxt", "svelte", "django"], vue: ["nuxt"] }
	- const hoursSpentWith = tech => (Object.keys(wakatimeAggregated.languages).includes(tech.URLName) ? Math.floor(wakatimeAggregated.languages[tech.URLName] / 3600) : 0)
	- const hoursIncludingPreprocs = tech => hoursSpentWith(tech) + (Object.keys(preprocessorsOf).includes(tech.URLName) ? preprocessorsOf[tech.URLName].reduce((acc, preproc) => acc + hoursSpentWith({ URLName: preproc }), 0) : 0)
	- const projectsUsing = tech => madeWith(all_works, tech)
	- const technologies = domain => all_technologies.filter(t => domain.includes(t.URLName)).filter(t => hoursIncludingPreprocs(t) || projectsUsing(t).length).sort((a, b) => hoursIncludingPreprocs(a) - hoursIncludingPreprocs(b) + projectsUsing(a).length - projectsUsing(b).length).reverse()

	p.pre-h1 Ewen Le Bihan
	h1 curriculum vitæ

	section.skills
		h2 skills
		h3 language
		ul.skills-list
			li.skill
				h4 French
				p Native

			li.skill
				h4 English
				dl
					dt
						| TOEIC
					dd
						| 950
						span.fraction-slash ⁄
						| 990
						span.date 12 March 2020

					dt CECRL
					dd C1

					dt ILR
					dd 4

					dt ACTFL
					dd S

		h3 programming
		ul.skills-list
			each tech in technologies(programmingTechnologies)
				+skill(tech)

		h3 graphic design
		ul.skills-list
			each tech in technologies(graphicDesignSoftware)
				+skill(tech)

		h3 motion design
		ul.skills-list
			each tech in technologies(motionDesignSoftware)
				+skill(tech)

		h3 music making
		ul.skills-list
			each tech in technologies(musicMakingSoftware)
				+skill(tech)
